% SPDX-License-Identifier: CC-BY-SA-4.0
% Author: Matthieu Perrin
% Part: 
% Section: 
% Sub-section: 
% Frame: 

\begingroup

\SetKwFunction{Decide}{decider}
\SetKwData{Mot}{u}
\SetKwData{VuA}{vuA}
\SetKwData{VuB}{vuB}

\begin{frame}{Exemple d'algorithme d'analyse lexicale}

  \tf[text,y=1.5]{
    \begin{algorithm}[H]
      \Fn{\Decide(\Mot : mot) : booléen}{
        $\tfAlert<2>{\alert<2->\VuA} \leftarrow \tfAlert<3>{\False}$, $\tfExample<2>{\example<2->\VuB} \leftarrow \tfAlert<3>{\False}$\;
        \Pour{$i$ de $1$ à $|\Mot|$}{
          \uSi{\tfStructure<4,5>{$\Mot[i] = \text{`a'} \land \lnot \VuB$}}{
            \tfAlert<4>{$\VuA \leftarrow \True$}\;
          }\uSinonSi{\tfStructure<6-8>{$\Mot[i]=\text{`b'} \land \VuA$}}{
            \tfAlert<6>{$\VuB \leftarrow \True$}\;
          }\lSinon{\Retourner \False}
        }
        \Retourner \tfAlert<9>{$\VuA \land \VuB$}\; 
      }
    \end{algorithm}
  }

  \tfBlock[text,y=-2.3]{Représentation graphique}{
    \begin{tikzpicture}[smAutomaton]
      \uncover<2-|handout>{
        \smState               at  (1.1,1.8) {$q$}; 
        \node[right]           at  (1.5,1.8) {état de l'algorithme}; 
      }
      \uncover<3-|handout>{
        \smState[\smInitial]   at (1.1,0.9) {$i$}; 
        \node[right]           at (1.5,0.9) {initial}; 
      }
      \uncover<4-|handout>{
        \smState       (start) at (1.1,0)   {$q_1$}; 
        \smState       (end)   at (2.7,0)   {$q_2$}; 
        \node[right]           at (3.1,0)   {transition}; 
        \smPath  (start) edge node {a} (end);
      }
      \uncover<9-|handout>{
        \smState[\smAccepting] at (3.6,0.9) {$f$}; 
        \node[right]           at (4.0,0.9) {final}; 
      }
    \end{tikzpicture}
  }
  
  \tfBlock[right=4cm, y=3] {Expression rationnelle} {
    \vspace{-4mm}
    \[\textstyle a^+ b^+ \]
  }
  
  \tfBlock<2|handout>[right=4cm,y=2,anchor=north]{Variables}{
    \begin{itemize}
    \item \alert{\VuA} : a-t-on vu un $a$ ?
    \item \example{\VuB} : a-t-on vu un $b$ ?
    \end{itemize}
  }

  
  \tfBlock<3->[right=4cm,y=2,anchor=north]{Exemple d'exécution}{
    \centering
    \begin{smArray}[size=5mm, headsize=2mm, name={\Mot :}]
      \smHead<3> 
      \smCell         {a} \smHead<4> 
      \smCell         {a} \smHead<5> 
      \smCell         {b} \smHead<6> 
      \smCell         {b} \smHead<7> 
      \smCell         {b} \smHead<8> 
      \smCell[\smNone]{ } \smHead<9> 
    \end{smArray}
    \uncover<9>{\alert{Mot reconnu}}
  }

  \tf<2-|handout>[x=3,y=-2.3cm]{
    \begin{smAutomaton}
      \draw[opacity=0] (-1.5,-1) rectangle (3,3);
      
      \smState[\smInitial<3-|handout> \smAlert<3>  \smStructure<4>] (00) at (0.0,1.5) {\alert{0}\example{0}}; 
      \smState[                       \smAlert<4-5>\smStructure<6>] (10) at (1.5,1.5) {\alert{1}\example{0}}; 
      \smState[\smAccepting<9|handout>\smAlert<6->                ] (11) at (1.5,0.0) {\alert{1}\example{1}};
      \smState[                                                   ] (01) at (0.0,0.0) {\alert{0}\example{1}};
      
      \smPath<4->[\smStructure<4>]   (00) edge             node {$a$} (10);
      \smPath<5->[\smStructure<5>]   (10) edge[loop above] node {$a$} (10); 
      \smPath<6->[\smStructure<6>]   (10) edge             node {$b$} (11); 
      \smPath<7->[\smStructure<7-8>] (11) edge[loop right] node {$b$} (11); 
    \end{smAutomaton}
  }
  
\end{frame}

\endgroup
