% SPDX-License-Identifier: CC-BY-SA-4.0
% Author: Matthieu Perrin
% Part: 
% Section: 
% Sub-section: 
% Frame: 

\begingroup

\begin{frame}{Construction de l'automate sous-jacent}
  
  \on[text, top=-1mm]{
    On construit un automate fini déterministe sur l'alphabet $\Sigma \cup \Gamma$  :
    \begin{itemize}
    \item \structure{L'état initial} est $\alert{\mathit{fermeture}\left(\{S \rightarrow \bullet A \$ \}\right)}$
    \item<2-|handout> Pour tout $a \in \Sigma \cup \Gamma$ et tout état $E$, ajouter \structure{$E_a$} et \structure{$E \xrightarrow{a} E_a$}, avec
      $$E_a \eqdef \alert{\mathit{fermeture}\left(\left\{ A \rightarrow \alpha a \bullet \beta \mid A \rightarrow \alpha \bullet a \beta \in E\right\}\right)}$$
    \item<2-|handout> L'ensemble d'items vide $\emptyset$ est \structure{l'état puits d'erreur} (à émonder)
    \item<3-|handout> \structure{L'état final} est \alert{$\{S \rightarrow A \$ \bullet \}$}
    \end{itemize}
  }
  
  \onExampleBlock[bottom]{Exemple pour le langage $\left\{ a^n c b^n \mid n\in \mathbb{N}\right\}$}{\footnotesize\centering
    \begin{tikzpicture}[automaton, x=27mm, y=10mm]
      \tikzset{
        lrstate/.style={rectangle, minimum width=22mm, minimum height=8mm},
        lrpath/.style={},
      }
      
      \state[lrstate, initial]   (I) at (0,0) {\only<-3|handout>{$
          \left\{\begin{array}{@{\,}r@{\,}c@{\,}l@{\,}}
          S &\rightarrow& \bullet A \$\\
          A &\rightarrow& \bullet a A b \mid \bullet c
          \end{array}\right.
          $}\onlyb<4>{0}};
      
      \uncoverb<2>{
        \state[lrstate, fade] (E) at (0.9,2) {$\emptyset$};
        \path[lrpath, fade] (I) edge   node[sloped] {$b, S, \$$} (E);
      }
      
      \uncover<2->{
        \state[lrstate]            (C) at (1,1) {\only<-3|handout>{$
            \left\{\begin{array}{@{\,}r@{\,}c@{\,}l@{\,}}
            S &\rightarrow& A \$\\
            A &\rightarrow& a A b \mid  c \bullet
            \end{array}\right.
            $}\onlyb<4>{2}};
        \state[lrstate]            (A) at (0,2) {\only<-3|handout>{$
            \left\{\begin{array}{@{\,}r@{\,}c@{\,}l@{\,}}
            S &\rightarrow& A \$\\
            A &\rightarrow& \bullet a \bullet A b \mid \bullet c
            \end{array}\right.
            $}\onlyb<4>{3}}; 
        \state[lrstate] (X) at (2,0) {\only<-3|handout>{$
            \left\{\begin{array}{@{\,}r@{\,}c@{\,}l@{\,}}
            S &\rightarrow& A \bullet \$\\
            A &\rightarrow& a A b \mid c
            \end{array}\right.
            $}\onlyb<4>{1}};
        \path[lrpath] (I) edge             node[swap] {$A$} (X);
        \path[lrpath] (I) edge             node[swap] {$a$} (A);
        \path[lrpath] (I) edge             node {$c$} (C);
      }
      \uncover<3->{
        \state[lrstate]            (S) at (2,2) {\only<-3|handout>{$
            \left\{\begin{array}{@{\,}r@{\,}c@{\,}l@{\,}}
            S &\rightarrow& A \$\\
            A &\rightarrow& a A \bullet b \mid c
            \end{array}\right.
            $}\onlyb<4>{4}};  
        \state[lrstate]            (B) at (3,2) {\only<-3|handout>{$
            \left\{\begin{array}{@{\,}r@{\,}c@{\,}l@{\,}}
            S &\rightarrow& A \$\\
            A &\rightarrow& a A b \bullet \mid  c
            \end{array}\right.
            $}\onlyb<4>{5}};
      }
      \uncover<3->{
        \state[lrstate, accepting] (F) at (3,0) {\only<-3|handout>{$
            \left\{\begin{array}{@{\,}r@{\,}c@{\,}l@{\,}}
            S &\rightarrow& A \$ \bullet\\
            A &\rightarrow& a A b \mid c
            \end{array}\right.
            $}\onlyb<4>{6}};
        
        \path[lrpath] (A) edge[loop above] node {$a$} (A);
        \path[lrpath] (A) edge             node[swap] {$c$} (C);
        \path[lrpath] (S) edge             node {$b$} (B);
        \path[lrpath] (A) edge             node {$A$} (S);
        \path[lrpath] (X) edge             node[swap] {$\$$} (F);
      }
    \end{tikzpicture}
  }

\end{frame}

\endgroup
