% SPDX-License-Identifier: CC-BY-SA-4.0
% Author: Matthieu Perrin
% Part: 
% Section: 
% Sub-section: 
% Frame: 

\begingroup

\SetKwFunction{CYK}{CYK}

\begin{frame}[fragile]{Algorithme Cocke-Younger-Kasami (CYK)}

  \on[top=-2mm, text]{\small
    \begin{algorithm}[H]
      \Fun{\CYK($\langle \Sigma, \Gamma, S, \rightarrow \rangle$ : grammaire, $u \in \Sigma^\star$) : booléen}{
        \lIf{$u = \varepsilon$}{\Return $S \rightarrow \varepsilon$}
        \For{$j$ \From $1$ \To $|u|$}{
          \Alertb<3>{$T[1, j] \leftarrow \{N\in \Gamma \mid N \rightarrow u[j]\}$}\;
        }
        \For{$i$ \From $2$ \To $|u|$}{
          \For{$j$ \From $1$ \To $|u|-i+1$}{
            \Alertb<4->{$\displaystyle T[i, j] \leftarrow \bigcup_{k=1}^{i-1} \left\{N\in \Gamma \,\middle\mid\, \exists X \in T[k,j], \exists Y \in T[i-k,j+k],~ N \rightarrow X Y\right\}$}\;
          }
        }
        \Return \Alertb<2>{$S\in T[|u|, 1]$}\;
      }
    \end{algorithm}
  }

  \onExampleBlock[bottom]{Exemple}{
    \vspace{2mm}
    $\begin{array}{@{}l@{~=~}l@{}}
    G & \left\{\begin{array}{@{~}l@{~}l@{~}l@{\,}}
    \alertb<5,9>{S} &\alertb<5,9>{\rightarrow}&  \alertb<9>{AC} \mid \alertb<5>{AB} \mid \varepsilon  \\
    \alertb<8>{C} &\alertb<8>{\rightarrow}&  \alertb<8>{TB}  \\
    \alertb<5,9>{T} &\alertb<5,9>{\rightarrow}&  \alertb<9>{AC} \mid \alertb<5>{AB}  \\
    \alertb<3>{A} &\alertb<3>{\rightarrow}& \alertb<3>{a}  \\
    \alertb<3>{B} &\alertb<3>{\rightarrow}& \alertb<3>{b}
    \end{array}\right.\\
    u & aabb
    \end{array}$
  }

  \on[x=17mm, y=-2cm]{
    \begin{tikzpicture}
      {\scriptsize
        \draw (-.75,2.8) node[above left]{\scriptsize $T[i,j]$};
        \draw (0.0 ,2.8) node[above]     {\scriptsize $j=1$};
        \draw (1.5 ,2.8) node[above]     {\scriptsize $j=2$};
        \draw (3.0 ,2.8) node[above]     {\scriptsize $j=3$};
        \draw (4.5 ,2.8) node[above]     {\scriptsize $j=4$};
        \draw (-.75,2.4) node[left]      {\scriptsize $i=1$};
        \draw (-.75,1.6) node[left]      {\scriptsize $i=2$};
        \draw (-.75,0.8) node[left]      {\scriptsize $i=3$};
        \draw (-.75,0.0) node[left]      {\scriptsize $i=4$};
      }
      
      \node (a1) at (0.0,2.4) {}; 
      \node (a2) at (1.5,2.4) {}; 
      \node (a3) at (3.0,2.4) {}; 
      \node (a4) at (4.5,2.4) {}; 
      \node (b1) at (0.0,1.6) {}; 
      \node (b2) at (1.5,1.6) {}; 
      \node (b3) at (3.0,1.6) {}; 
      \node (c1) at (0.0,0.8) {}; 
      \node (c2) at (1.5,0.8) {}; 
      \node (d1) at (0.0,0.0) {}; 

      \draw[fill=structure!15] (a1) +(-.75,-.4) rectangle +(.75,.4);
      \draw[fill=structure!15] (a2) +(-.75,-.4) rectangle +(.75,.4);
      \draw[fill=structure!15] (a3) +(-.75,-.4) rectangle +(.75,.4);
      \draw[fill=structure!15] (a4) +(-.75,-.4) rectangle +(.75,.4);
      \draw[fill=structure!15] (b1) +(-.75,-.4) rectangle +(.75,.4);
      \draw[fill=structure!15] (b2) +(-.75,-.4) rectangle +(.75,.4);
      \draw[fill=structure!15] (b3) +(-.75,-.4) rectangle +(.75,.4);
      \draw[fill=structure!15] (c1) +(-.75,-.4) rectangle +(.75,.4);
      \draw[fill=structure!15] (c2) +(-.75,-.4) rectangle +(.75,.4);
      \draw[fill=structure!15] (d1) +(-.75,-.4) rectangle +(.75,.4);

      {\footnotesize
        \draw[example] (a1) +(-.75,-.4) node[above right] {$a$};
        \draw[example] (a2) +(-.75,-.4) node[above right] {$a$};    
        \draw[example] (a3) +(-.75,-.4) node[above right] {$b$};    
        \draw[example] (a4) +(-.75,-.4) node[above right] {$b$};    
        \draw[example] (b1) +(-.75,-.4) node[above right] {$aa$};   
        \draw[example] (b2) +(-.75,-.4) node[above right] {$ab$};   
        \draw[example] (b3) +(-.75,-.4) node[above right] {$bb$};   
        \draw[example] (c1) +(-.75,-.4) node[above right] {$aab$};  
        \draw[example] (c2) +(-.75,-.4) node[above right] {$abb$};  
        \draw[example] (d1) +(-.75,-.4) node[above right] {$aabb$}; 
      }
      
      \onlyb<1>{
        \draw[-latex, example] (1.25,0.9) -- (1.25,2.5);
        \draw[-latex, example] (1.25,0.9) -- (4.25,2.5);
      }\onlyb<2>{
        \node[structure] at (a1) {$\{...\}$};
        \node[structure] at (a2) {$\{...\}$};
        \node[structure] at (a3) {$\{...\}$};
        \node[structure] at (a4) {$\{...\}$};
        \node[structure] at (b1) {$\{...\}$};
        \node[structure] at (b2) {$\{...\}$};
        \node[structure] at (b3) {$\{...\}$};
        \node[structure] at (c1) {$\{...\}$};
        \node[structure] at (c2) {$\{...\}$};
        \node[structure] at (d1) {$\{...\alert{S?}...\}$};
      }\only<3->{
        \node[structure] at (a1) {$\{A\}$};
        \node[structure] at (a2) {$\{A\}$};
        \node[structure] at (a3) {$\{B\}$};
        \node[structure] at (a4) {$\{B\}$};
      }\only<4->{
        \node[structure] at (b1) {$\emptyset$};
      }\only<5->{
        \node[structure] at (b2) {$\{S, T\}$};
      }\only<6->{
        \node[structure] at (b3) {$\emptyset$};
      }\only<7->{
        \node[structure] at (c1) {$\emptyset$};
      }\onlyb<7>{
        \draw[alert] (0.0,2.55)  -- (1.5,1.75);
        \draw[alert] (0.0,1.75)  -- (3.0,2.55);
      }\only<8->{
        \node<8->[structure] at (c2) {$\{C\}$};
      }\onlyb<8>{
        \draw[alert] (1.5,2.55)  -- (3.0,1.75);
        \draw[alert] (1.5,1.75)  -- (4.5,2.55);
      }\only<9->{
        \node[structure] at (d1) {$\{\alert{S}, T\}$};
      }\onlyb<9>{
        \draw[alert] (0,2.55)  -- (1.5,0.95)  ;
        \draw[alert] (0,1.75)  -- (3.0,1.75)  ;
        \draw[alert] (0,0.95)  -- (4.5,2.55)  ;
      }
    \end{tikzpicture}
  }

  \on[width=40mm, x=43mm, y=-23mm, anchor=north]{\small%
    \only<-2>{%
      \example{%
        $T[i,j]$ représente le facteur \\
        $u_{i,j} = u[j] \cdots u[j+i]$\\\vspace{2mm}
      }%
    }%
    \only<2>{%
      \structure{%
        $T[i,j]$ contient \\
        $\{N \in \Gamma \mid N \vdash^\star u_{i,j}\}$
      }%
    }%
    \onlyb<4>{%
      On cherche \alert{$N \rightarrow XY \vdash aa$}\\
      $\bullet$ $X = A \in T[1,1]$ \\
      $\bullet$ $Y = A \in T[1,2]$ \\
      Pas de règle \alert{$N \rightarrow AA$}\\
    }%
    \onlyb<5>{%
      On cherche \alert{$N \rightarrow XY \vdash ab$}\\
      $\bullet$ $X = A \in T[1,2]$ \\
      $\bullet$ $Y = B \in T[1,3]$ \\
      Deux règles \alert{$N \rightarrow AB$}\\
    }%
    \onlyb<6>{%
      On cherche \alert{$N \rightarrow XY \vdash bb$}\\
      $\bullet$ $X = B \in T[1,3]$ \\
      $\bullet$ $Y = B \in T[1,4]$ \\
      Pas de règle \alert{$N \rightarrow BB$}\\
    }%
    \onlyb<7>{%
      $aab = a \cdot ab = aa \cdot b$\\
      On cherche \alert{$N \rightarrow XY$}\\
      $\bullet$ $X \vdash^\star a$, $Y \vdash^\star ab$  \\
      $\bullet$ $X \vdash^\star aa$, $Y \vdash^\star b$  \\
      \footnotesize \alert{$XY \in \{A\} \cdot \{S, T\} \cup \emptyset \cdot \{B\}$}\\
      Pas de règle \alert{$N \rightarrow AS$} ou \alert{$N \rightarrow AT$}\\
    }%
    \onlyb<8>{%
      $aab = a \cdot bb = ab \cdot b$\\
      On cherche \alert{$N \rightarrow XY$}\\
      $\bullet$ $X \vdash^\star a$, $Y \vdash^\star bb$  \\
      $\bullet$ $X \vdash^\star ab$, $Y \vdash^\star b$  \\
      \footnotesize \alert{$XY \in \{A\} \cdot \emptyset \cup \{S, T\} \cdot \{B\}$}\\
      Une règle \alert{$N \rightarrow TB$}\\
    }%
    \onlyb<9>{
      $\begin{array}{lll}
        aabb &=& a \cdot bbb\\
        &=& aa \cdot bb\\
        &=& aab \cdot b\\
        \alert{aabb} & \alert{\in} &\alert{\mathcal{L}(G)}
      \end{array}$
    }%
  }
\end{frame}

\endgroup
